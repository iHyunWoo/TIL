# JWT
- JSON web token
- 특징
	- 무상태
		- 클라이언트 측에 JWT를 저장하고, 서버는 세션 상태를 따로 유지할 필요가 없음
	- 데이터 포함
		- 토큰 안에 사용자 정보, 권한 정보, 만료 시간 등의 데이터가 포함
- 구성 요소
	- 헤더
		- 토큰의 타입(typ)과 서명 알고리즘(alg)를 정의
```json
{
	"alg": "HS256",
	"typ": "JWT"
}
```
- 페이로드
	- 토큰에 담길 클레임 정보 포함
	- 등록된 클레임 외에 개발자가 정의하여 클레임 추가 가능
	- 등록된 클레임
		- iss: 발급자
		- sub: 주제
		- aud: 대상
		- exp: 만료 시간
		- nbf: 활성 시작 시간
		- iat: 발급 시간
		- jti: JWT 고유 식별자
```json
{
  "userId": 365,
  "iat": 1609239023,
  "exp": 1609242623
}

```

- 서명
	- 헤더와 페이로드를 합친 뒤, 해시하고 비밀키를 사용하여 서명
	- 토큰이 변조되지 않았음을 검증
```js
HMACSHA256(
  base64UrlEncode(header) + "." + base64UrlEncode(payload),
  secret
)
```

## Access Token과 Refresh Token
##### Access Token

- 목적: 사용자가 인증된 상태임을 증명하며, 보호된 자원에 접근할 수 있도록 허용
- 특징:
    - 유효 기간이 짧음: 보안을 위해 만료 시간을 짧게 설정하여, 탈취 시 피해를 최소화
    - Self-contained: 사용자 정보와 권한 등의 클레임이 포함되어 있어 별도의 조회 없이 인증이 가능
    - 매 요청마다 사용: 클라이언트는 API 호출 시 Access Token을 전송하여 인증을 수행
##### Refresh Token

- 목적: 만료된 Access Token을 갱신하여 사용자가 재인증 없이 계속해서 서비스를 이용할 수 있도록 함
- 특징:
    - 유효 기간이 길음: Access Token보다 더 긴 만료 시간을 가짐
    - 보안에 민감: 탈취 시 장기적으로 위험할 수 있으므로, 저장 및 전송 시 추가 보안 조치(예: HttpOnly 쿠키, 안전한 스토리지 등)가 필요합니다.
    - Access Token 재발급: Access Token이 만료되면, Refresh Token을 이용해 새로운 Access Token을 발급받습니다.

## 세션 기반 인증과 JWT 인증의 장단점
##### 세션 기반 인증
- 장점
	- 서버에서 제어하기 용이함
	- 동시 접속 관리 가능
- 단점
	- 사용자가 많을 경우 세션 데이터 부하 발생
	- 분산 시스템에서 서버 간 세션 정보 공유 어려움
##### JWT 인증
- 장점
	- 서버가 별도의 세션을 관리할 필요가 없음
	- 분산 시스템에 유리
- 단점
	- 토큰 탈취 위험
	- 토큰 크기가 커 HTTP 헤더 부하 증가

## JWT와 세션 혼합 방식
- JWT의 단점을 보완하고 세션의 장점을 활용하기 위해 혼합하여 사용하는 경우도 있음
- Refresh Token을 서버의 세션에 저장
	- 각 사용자의 인증 상태를 중앙에서 관리 가능
- Access token을 클라이언트에 전달
	- 클라이언트 측에서 Access token을 관리하여 서버 부하 감소